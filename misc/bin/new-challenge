#!/bin/bash

set -e

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
BASE_DIR="$(dirname "$SCRIPT_DIR")"
TEMPLATE_DIR="$BASE_DIR/ts-starter"

if [ -z "$1" ]; then
    echo "Usage: new-challenge <name>"
    exit 1
fi

PROJECT_NAME="$1"
PROJECT_DIR="$BASE_DIR/$PROJECT_NAME"

if [ -d "$PROJECT_DIR" ]; then
    echo "Error: Directory '$PROJECT_NAME' already exists"
    exit 1
fi

if [ ! -d "$TEMPLATE_DIR" ]; then
    echo "Error: Template directory 'ts-starter' not found"
    exit 1
fi

echo "Creating new challenge: $PROJECT_NAME"

cp -r "$TEMPLATE_DIR" "$PROJECT_DIR"

echo "Installing dependencies..."
cd "$PROJECT_DIR"
npm install

echo "Opening in VS Code..."
code "$PROJECT_DIR"

echo "Done! Happy coding!"
